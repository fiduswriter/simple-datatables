/*!
 *
 * Vanilla-DataTables
 * Copyright (c) 2015 Karl Saunders (http://mobiuswebdesign.co.uk)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 0.1.0
 *
 */
!function(a,b){var c="DataTable";"function"==typeof define&&define.amd?define([],b(c)):"object"==typeof exports?module.exports=b(c):a[c]=b(c)}(this,function(a){"use strict";function l(a,c){var d={perPage:10,perPageSelect:[5,10,15,20,25],navPosition:"bottom",navButtons:!0,nextPrev:!0,prevText:"&lsaquo;",nextText:"&rsaquo;",sortable:!1,searchable:!1,fixedHeight:!1,info:!0,hideUnusedNavs:!1,truncatePager:!0,pagerDelta:2,plugins:[]};this.options=b(d,c);var e=a.tagName.toLowerCase();if("table"!=e)throw new Error("The selected element ("+e+") is not a table!");if(null===a.tHead&&this.options.sortable)throw new Error("The sortable option requires table headings!");if(this.table=a,this.thead=this.table.tHead,this.options.data){var f=k(this.options.data);this.clear(),this.table.appendChild(f)}this.tbody=this.table.tBodies[0],this.rows=Array.prototype.slice.call(this.tbody.rows),this.initialised=!1,this.sortEnabled=!1,this.isIE=!!/(msie|trident)/i.test(navigator.userAgent),this.paginators=[],this.currentPage=1,this.onFirstPage=!0,this.onLastPage=!1,this.searching=!1,this.init()}var b=function(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},c=function(a,b){return a.classList?a.classList.contains(b):!!a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))},d=function(a,b){a.classList?a.classList.add(b):c(b)||(a.className=a.className.trim()+" "+b)},e=function(a,b){a.classList?a.classList.remove(b):c(b)&&(a.className=a.className.replace(new RegExp("(^|\\c)"+b.split(" ").join("|")+"(\\c|$)","gi")," "))},f=function(){return document.createDocumentFragment()},g=function(a,b){var c=document,d=c.createElement(a);if(b&&"object"==typeof b){var e;for(e in b)if("html"===e)d.innerHTML=b[e];else if("text"===e){var f=c.createTextNode(b[e]);d.appendChild(f)}else d.setAttribute(e,b[e])}return d},h=function(a,b){var c,d;1===b?(c=0,d=a.length):b===-1&&(c=a.length-1,d=-1);for(var e=!0;e;){e=!1;for(var f=c;f!=d;f+=b)if(a[f+b]&&a[f].value>a[f+b].value){var g=a[f],h=a[f+b],i=g;a[f]=h,a[f+b]=i,e=!0}}return a},i=function(a,b,c){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.call(c,d,a[d],a);else for(var e=0,f=a.length;e<f;e++)b.call(c,e,a[e],a)},j=function(a,b,c,d){d=d||2;var l,f=2*d,g=b-d,h=b+d,j=[],k=[];b<4-d+f?h=3+f:b>c-(3-d+f)&&(g=c-(2+f));for(let m=1;m<=c;m++)if(1==m||m==c||m>=g&&m<=h){var n=a[m-1];e(n,"active"),j.push(n)}return i(j,(b,c)=>{var d=c.children[0].getAttribute("data-page");if(l){var e=l.children[0].getAttribute("data-page");if(d-e==2)k.push(a[e]);else if(d-e!=1){var f=_createElement("li",{class:"ellipsis",html:'<a href="#">&hellip;</a>'});k.push(f)}}k.push(c),l=c}),k},k=function(a){var b=f(),c=g("tbody");return i(a,function(a,c){var d=g("tr");i(c,function(a,b){var c=g("td",{html:b});d.appendChild(c)}),b.appendChild(d)}),c.appendChild(b),c};return l.prototype={init:function(){if(!this.initialised){var a=this;this.paginate(),this.wrapper=g("div",{class:"dataTable-wrapper"}),this.tableContainer=g("div",{class:"dataTable-container"}),this.selector=g("select",{class:"dataTable-selector"}),this.searchInput=g("input",{type:"text",class:"dataTable-input",placeholder:"Search..."}),this.label=g("div",{class:"dataTable-info"});var b=g("div",{class:"dataTable-top"}),e=g("div",{class:"dataTable-bottom"}),f=g("label",{class:"dataTable-selectWrapper"});if(i(this.options.perPageSelect,function(b,c){a.selector.appendChild(g("option",{value:c,html:c}))}),this.selector.value=this.options.perPage,f.appendChild(this.selector),f.insertAdjacentHTML("beforeend"," entries per page"),b.appendChild(f),d(this.table,"dataTable-table"),e.appendChild(this.label),this.wrapper.appendChild(b),this.wrapper.appendChild(this.tableContainer),this.wrapper.appendChild(e),this.options.searchable){var h=g("div",{class:"dataTable-search"});h.appendChild(this.searchInput),b.appendChild(h),d(b,"searchable")}this.showPage();var k,j=g("ul",{class:"dataTable-pagination"});switch(this.paginators.push(j),this.options.navPosition){case"top":b.appendChild(j);break;case"bottom":e.appendChild(j);break;case"both":k=g("ul",{class:"dataTable-pagination"}),this.paginators.push(k),b.appendChild(j),e.appendChild(k)}if(this.update(),this.options.sortable){if(this.sortEnabled)return;var a=this,l=a.thead.rows[0].cells;i(l,function(a,b){var c=g("a",{href:"#",class:"dataTable-sorter",html:b.innerHTML});b.idx=a,b.innerHTML="",b.appendChild(c)}),this.sortEnabled=!0}this.table.parentNode.insertBefore(this.wrapper,this.table),this.tableContainer.appendChild(this.table),this.containerRect=this.tableContainer.getBoundingClientRect(),this.options.fixedHeight&&(this.tableContainer.style.height=this.containerRect.height+"px");var m=a.table.tHead.rows[0].cells;i(m,function(b,c){var d=c.getBoundingClientRect(),e=d.width/a.containerRect.width*100;c.style.width=e+"%"}),this.options.plugins.length&&i(this.options.plugins,function(b,c){a[c]&&"function"==typeof a[c].init&&a[c].init(a)}),this.on=function(b,c){a.table.addEventListener(b,function(b){c.call(a)})},a.handleClickEvents=function(b){b=b||window.event;var d=b.target,e=d.nodeName.toLowerCase();"a"===e&&(d.hasAttribute("data-page")&&(a.switchPage(d.getAttribute("data-page")),b.preventDefault()),c(d,"dataTable-sorter")&&(a.sortItems(b),b.preventDefault()))},this.wrapper.addEventListener("click",a.handleClickEvents,!1),this.selector.addEventListener("change",a.update.bind(a),!1),this.searchInput.addEventListener("keyup",a.search.bind(a),!1),setTimeout(function(){a.emit("datatable.init")},10),a.initialised=!0}},paginate:function(){var a=this.options.perPage,b=this.searching?this.searchRows:this.rows;this.pages=b.map(function(c,d){return d%a==0?b.slice(d,d+a):null}).filter(function(a){return a}),this.lastPage=this.pages.length},switchPage:function(a){var b=this;if(a!=this.currentPage){if(isNaN(a)||(this.currentPage=parseInt(a,10)),"prev"==a){if(this.onFirstPage)return;this.currentPage--}if("next"==a){if(this.onLastPage)return;this.currentPage++}this.showPage(this.currentPage-1),this.options.truncatePager?this.renderPager():i(b.paginators,function(a,c){var f=c.children,g=b.options.hideNavs?"hidden":"disabled";i(f,function(a,b){e(b,"active"),e(b,"disabled"),e(b,"hidden")}),b.onFirstPage&&b.options.nextPrev&&d(c.firstElementChild,g),b.onLastPage&&b.options.nextPrev&&d(c.lastElementChild,g);var h=b.options.nextPrev?b.currentPage:b.currentPage-1;d(c.children[h],"active")}),this.emit("datatable.change")}},showPage:function(a){a=a||0;var b=this,c=this.pages;if(c.length){var d=f();switch(i(c[a],function(a,b){d.appendChild(b)}),b.clear(),b.tbody.appendChild(d),b.onFirstPage=!1,b.onLastPage=!1,b.currentPage){case 1:b.onFirstPage=!0;break;case b.lastPage:b.onLastPage=!0}}if(b.options.info){var j,e=0,g=0,h=0;c.length&&(e=b.currentPage-1,g=e*b.options.perPage,h=g+c[e].length,g+=1,j=this.searching?this.searchRows.length:this.rows.length);var k=["Showing ",g," to ",h," of ",j," rows"];this.label.innerHTML=k.join("")}},search:function(a){var b=this,c=a.target.value.toLowerCase();return this.searching=!0,this.searchRows=[],c.length?(this.clear(),i(this.rows,function(a,d){i(d.cells,function(a,e){var f=e.textContent.toLowerCase(),g=b.searchRows.indexOf(d)>-1;f.indexOf(c)>-1&&!g&&b.searchRows.push(d)})}),b.searchRows.length||b.setMessage("No entries found."),this.update(),void this.emit("datatable.search")):(this.searching=!1,this.update(),void this.emit("datatable.search"))},setMessage:function(a){this.clear(),this.tbody.appendChild(g("tr",{html:'<td class="dataTables-empty" colspan="'+this.colspan+'">'+a+"</td>"}))},update:function(a){if(a){var b=a.target;b===this.selector&&(this.options.perPage=parseInt(b.value,10)),this.emit("datatable.perpage")}this.currentPage=1,this.paginate(),this.showPage();var c=this;this.links=[],i(this.pages,function(a,b){var d=_createElement("li",{class:0==a?"active":""}),e=_createElement("a",{href:"#","data-page":a+1,html:a+1});d.appendChild(e),c.links.push(d)}),this.renderPager(),this.initialised&&(this.tableContainer.style.height=null,this.options.fixedHeight&&(this.containerRect=this.tableContainer.getBoundingClientRect(),this.tableContainer.style.height=this.containerRect.height+"px"))},renderPager:function(){function g(b,c){var d=_createElement("li",{class:c}),e=_createElement("a",{href:"#","data-page":b,html:"prev"==b?a.options.prevText:a.options.nextText});return d.appendChild(e),d}if(!(this.pages.length<=1)){var a=this,b=f(),c=a.options.hideNavs?"hidden":"disabled";b.appendChild(g("prev",a.onFirstPage?c:""));var e=j(this.links,this.currentPage,this.pages.length,this.options.pagerDelta);switch(d(this.links[this.currentPage-1],"active"),i(e,(a,c)=>{b.appendChild(c)}),a.options.nextPrev&&b.appendChild(g("next",a.onLastPage?c:"")),this.options.navPosition){case"top":case"bottom":this.paginators[0].innerHTML="",this.paginators[0].appendChild(b);break;case"both":this.paginators[0].innerHTML="",this.paginators[0].appendChild(b),this.paginators[1].innerHTML="",this.paginators[1].appendChild(this.paginators[0].cloneNode(!0))}}},sortItems:function(a){var g,b=this,f=a.target,j=b.searching?b.searchRows:b.rows,k=[],l=[],m=0,n=0,o=f.parentNode;i(j,function(a,b){var c=b.cells[o.idx],d=c.textContent?c.textContent:c.innerText,e=d.replace(/(\$|\,|\s)/g,"");parseFloat(e)==e?l[n++]={value:Number(e),row:b}:k[m++]={value:d,row:b}});var q,r;c(o,"asc")?(q=h(k,-1),r=h(l,-1),g="descending",e(o,"asc"),d(o,"desc")):(q=h(l,1),r=h(k,1),g="ascending",e(o,"desc"),d(o,"asc")),this.lastTh&&o!=this.lastTh&&(e(this.lastTh,"desc"),e(this.lastTh,"asc")),this.lastTh=o;var j=q.concat(r);b.searching?(b.searchRows=[],i(j,function(a,c){b.searchRows.push(c.row)})):(b.rows=[],i(j,function(a,c){b.rows.push(c.row)})),b.sortOrder=g,b.update(a),b.emit("datatable.sort")},clear:function(){if(this.table.tBodies.length)if(this.isIE)for(;this.tbody.hasChildNodes();)this.tbody.removeChild(this.tbody.firstChild);else this.tbody.innerHTML=""},emit:function(a){this.table.dispatchEvent(new Event(a))}},l});